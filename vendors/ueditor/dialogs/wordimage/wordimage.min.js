var wordImage={};var g=baidu.g,flashObj,flashContainer;wordImage.init=function(a,b){showLocalPath("localPath");createFlashUploader(a,b);addUploadListener();addOkListener()};function hideFlash(){flashObj=null;flashContainer.innerHTML=""}function addOkListener(){dialog.onok=function(){if(!imageUrls.length){return}var b=editor.getOpt("imageUrlPrefix"),a=domUtils.getElementsByTagName(editor.document,"img");editor.fireEvent("saveScene");for(var f=0,c;c=a[f++];){var h=c.getAttribute("word_img");if(!h){continue}for(var e=0,d;d=imageUrls[e++];){if(h.indexOf(d.original.replace(" ",""))!=-1){c.src=b+d.url;c.setAttribute("_src",b+d.url);c.setAttribute("title",d.title);domUtils.removeAttributes(c,["word_img","style","width","height"]);editor.fireEvent("selectionchange");break}}}editor.fireEvent("saveScene");hideFlash()};dialog.oncancel=function(){hideFlash()}}function addUploadListener(){g("upload").onclick=function(){flashObj.upload();this.style.display="none"}}function showLocalPath(h){var b=editor.selection.getRange().getClosedNode();var a=editor.execCommand("wordimage");if(a.length==1||b&&b.tagName=="IMG"){g(h).value=a[0];return}var e=a[0];var d=e.lastIndexOf("/")||0,c=e.lastIndexOf("\\")||0,f=d>c?"/":"\\";e=e.substring(0,e.lastIndexOf(f)+1);g(h).value=e}function createFlashUploader(b,d){var e=utils.extend({},lang.flashI18n);for(var a in e){if(!(a in {lang:1,uploadingTF:1,imageTF:1,textEncoding:1})&&e[a]){e[a]=encodeURIComponent(editor.options.langPath+editor.options.lang+"/images/"+e[a])}}b=utils.extend(b,e,false);var c={createOptions:{id:"flash",url:b.flashUrl,width:b.width,height:b.height,errorMessage:lang.flashError,wmode:browser.safari?"transparent":"window",ver:"10.0.0",vars:b,container:b.container}};c=extendProperty(d,c);flashObj=new baidu.flash.imageUploader(c);flashContainer=$G(b.container)}function extendProperty(a,c){for(var b in a){if(!c[b]){c[b]=a[b]}}return c}function getPasteData(a){baidu.g("msg").innerHTML=lang.copySuccess+"</br>";setTimeout(function(){baidu.g("msg").innerHTML=""},5000);return baidu.g(a).value}function createCopyButton(d,c){baidu.swf.create({id:"copyFlash",url:"fClipboard_ueditor.swf",width:"58",height:"25",errorMessage:"",bgColor:"#CBCBCB",wmode:"transparent",ver:"10.0.0",vars:{tid:c}},d);var b=baidu.swf.getMovie("copyFlash");var a=setInterval(function(){if(b&&b.flashInit){clearInterval(a);b.setHandCursor(true);b.setContentFuncName("getPasteData")}},500)}createCopyButton("clipboard","localPath");